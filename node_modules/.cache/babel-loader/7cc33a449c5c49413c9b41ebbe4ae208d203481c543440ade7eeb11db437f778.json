{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { getCookie, setCookie } from '@/services/cookies/cookieUtils';\nimport { getGamesData } from '@/services/api/gamesAPI';\nimport GalleryOptions from './GalleryOptions.vue';\nimport GameCard from './GameCard.vue';\nexport default {\n  name: 'GamesGallery',\n  components: {\n    GameCard,\n    GalleryOptions\n  },\n  data() {\n    return {\n      gamesData: [],\n      favorites: [],\n      search: localStorage.getItem(\"search\") || \"\",\n      gamesSortType: localStorage.getItem(\"gamesSortType\") || \"default\",\n      gamesFilterPlat: localStorage.getItem(\"gamesFilterPlat\") || \"All\",\n      gamesFilterGenre: localStorage.getItem(\"gamesFilterGenre\") || \"default\",\n      gridView: localStorage.getItem(\"gridView\") === true,\n      gamesSortFavorites: localStorage.getItem(\"gamesSortFavorites\") === false\n    };\n  },\n  watch: {},\n  created: function () {\n    this.retrieveGamesData();\n  },\n  computed: {\n    searchingList() {\n      return this.gamesData.filter(gamesData => {\n        return gamesData.title.toLowerCase().includes(this.search.toLowerCase());\n      });\n    },\n    gamesOrganizedData: function () {\n      let sortedData = this.gamesData.slice();\n      const field = [\"AZName\", \"ZAName\"].includes(this.gamesSortType) ? \"title\" : [\"RecenttoOld\", \"OldtoRecent\"].includes(this.gamesSortType) ? \"release_date\" : [\"default\"].includes(this.gamesSortType);\n      const reversed = [\"ZAName\", \"OldtoRecent\"].includes(this.gamesSortType);\n      sortedData = this.searchingList.slice().sort((a, b) => {\n        if (field === \"title\") {\n          return a[field].localeCompare(b[field]);\n        } else if (field === \"release_date\") {\n          return Date.parse(a[field]) - Date.parse(b[field]);\n        }\n      });\n      if (reversed) sortedData = sortedData.reverse();\n      return sortedData;\n    },\n    gamesFilteredPlatData: function () {\n      let filteredData = this.gamesOrganizedData;\n      if (this.gamesFilterPlat !== 'All') {\n        filteredData = filteredData.filter(item => item.platform === this.gamesFilterPlat);\n      }\n      return filteredData;\n    },\n    gamesFilteredGenreData: function () {\n      let filteredData = this.gamesFilteredPlatData;\n      if (this.gamesFilterGenre !== 'default') {\n        filteredData = filteredData.filter(game => game.genre === this.gamesFilterGenre);\n      }\n      return filteredData;\n    },\n    gamesFilteredFavoritesData: function () {\n      let favoritesData = this.gamesFilteredGenreData;\n      if (this.gamesSortFavorites === true) {\n        favoritesData = favoritesData.filter(game => this.favorites.includes(game.id));\n      }\n      return favoritesData;\n    }\n  },\n  methods: {\n    async retrieveGamesData() {\n      this.gamesData = await getGamesData();\n    },\n    isGameLiked(gameId) {\n      return this.favorites.includes(gameId);\n    },\n    toggleLike(gameId) {\n      console.log(document.cookie);\n      const game = this.gamesFilteredGenreData.find(game => game.id === gameId);\n      console.log(game.isLiked);\n      if (game) {\n        game.isLiked = !game.isLiked;\n        if (game.isLiked) {\n          this.favorites.push(game.id);\n        } else {\n          const index = this.favorites.indexOf(game.id);\n          if (index !== -1) {\n            this.favorites.splice(index, 1);\n          }\n        }\n        setCookie('favorites', JSON.stringify(this.favorites), 30);\n        console.log(document.cookie);\n        /* Supprimer les cookies si y a un soucis */\n        /*var Cookies = document.cookie.split(';');\r\n        // set past expiry to all cookies\r\n        for (var i = 0; i < Cookies.length; i++) {\r\n        document.cookie = Cookies[i] + \"=; expires=\"+ new Date(0).toUTCString();\r\n        }*/\n      }\n    },\n\n    toggleSortFavorites() {\n      this.gamesSortFavorites = !this.gamesSortFavorites;\n      localStorage.setItem(\"gamesSortFavorites\", this.gamesSortFavorites);\n    }\n  }\n};","map":{"version":3,"mappings":";AAuDI,SAASA,SAAS,EAAEC,SAAQ,QAAS,gCAAgC;AAErE,SAASC,YAAW,QAAS,yBAAyB;AAItD,OAAOC,cAAa,MAAO,sBAAqB;AAChD,OAAOC,QAAO,MAAO,gBAAgB;AAErC,eAAe;EACfC,IAAG,EAAI,cAAc;EAErBC,UAAS,EAAI;IACTF,QAAQ;IACRD;EACJ,CAAC;EAEDI,IAAI,GAAG;IACH,OAAO;MACHC,SAAQ,EAAI,EAAE;MAEdC,SAAQ,EAAI,EAAE;MAEdC,MAAM,EAAEC,YAAY,CAACC,OAAO,CAAC,QAAQ,KAAK,EAAE;MACrDC,aAAa,EAAEF,YAAY,CAACC,OAAO,CAAC,eAAe,KAAK,SAAS;MACxDE,eAAe,EAAEH,YAAY,CAACC,OAAO,CAAC,iBAAiB,KAAK,KAAK;MACjEG,gBAAgB,EAAEJ,YAAY,CAACC,OAAO,CAAC,kBAAkB,KAAK,SAAS;MAEvEI,QAAQ,EAAEL,YAAY,CAACC,OAAO,CAAC,UAAU,MAAM,IAAI;MAEpDK,kBAAkB,EAAEN,YAAY,CAACC,OAAO,CAAC,oBAAoB,MAAM;IACtE;EACJ,CAAC;EAEDM,KAAI,EAAG,CAEP,CAAC;EAIDC,OAAO,EAAE,YAAU;IAEf,IAAI,CAACC,iBAAiB,EAAE;EAI5B,CAAC;EAEDC,QAAQ,EAAE;IACNC,aAAa,GAAE;MACX,OAAO,IAAI,CAACd,SAAS,CAACe,MAAM,CAAEf,SAAS,IAAK;QACxC,OAAOA,SAAS,CAACgB,KAAK,CAACC,WAAW,EAAE,CAACC,QAAQ,CAAC,IAAI,CAAChB,MAAM,CAACe,WAAW,EAAE,CAAC;MAC5E,CAAC;IACL,CAAC;IAEDE,kBAAkB,EAAE,YAAW;MAC3B,IAAIC,UAAS,GAAI,IAAI,CAACpB,SAAS,CAACqB,KAAK,EAAC;MACtC,MAAMC,KAAI,GAAI,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAACJ,QAAQ,CAAC,IAAI,CAACb,aAAa,IAAI,OAAM,GAAI,CAAC,aAAa,EAAE,aAAa,CAAC,CAACa,QAAQ,CAAC,IAAI,CAACb,aAAa,IAAI,cAAa,GAAI,CAAC,SAAS,CAAC,CAACa,QAAQ,CAAC,IAAI,CAACb,aAAa,CAAC;MACnM,MAAMkB,QAAO,GAAI,CAAC,QAAQ,EAAE,aAAa,CAAC,CAACL,QAAQ,CAAC,IAAI,CAACb,aAAa;MACtEe,UAAS,GAAI,IAAI,CAACN,aAAa,CAACO,KAAK,EAAE,CAACG,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;QACnD,IAAIJ,KAAI,KAAM,OAAO,EAAE;UACvB,OAAOG,CAAC,CAACH,KAAK,CAAC,CAACK,aAAa,CAACD,CAAC,CAACJ,KAAK,CAAC;QACtC,OAAO,IAAIA,KAAI,KAAM,cAAc,EAAE;UACrC,OAAOM,IAAI,CAACC,KAAK,CAACJ,CAAC,CAACH,KAAK,CAAC,IAAIM,IAAI,CAACC,KAAK,CAACH,CAAC,CAACJ,KAAK,CAAC;QACjD;MACJ,CAAC;MACD,IAAIC,QAAQ,EAAEH,UAAS,GAAIA,UAAU,CAACU,OAAO,EAAC;MAC9C,OAAOV,UAAS;IAEpB,CAAC;IAEDW,qBAAqB,EAAE,YAAW;MAC9B,IAAIC,YAAW,GAAI,IAAI,CAACb,kBAAkB;MAC1C,IAAI,IAAI,CAACb,eAAc,KAAM,KAAK,EAAE;QAChC0B,YAAW,GAAIA,YAAY,CAACjB,MAAM,CAACkB,IAAG,IAAKA,IAAI,CAACC,QAAO,KAAM,IAAI,CAAC5B,eAAe,CAAC;MACtF;MACA,OAAO0B,YAAY;IACvB,CAAC;IAEDG,sBAAsB,EAAE,YAAW;MACnC,IAAIH,YAAW,GAAI,IAAI,CAACD,qBAAqB;MAC7C,IAAI,IAAI,CAACxB,gBAAe,KAAM,SAAS,EAAE;QACrCyB,YAAW,GAAIA,YAAY,CAACjB,MAAM,CAACqB,IAAG,IAAKA,IAAI,CAACC,KAAI,KAAM,IAAI,CAAC9B,gBAAgB,CAAC;MACpF;MACA,OAAOyB,YAAY;IACnB,CAAC;IAEDM,0BAA0B,EAAE,YAAW;MACnC,IAAIC,aAAY,GAAI,IAAI,CAACJ,sBAAsB;MAC/C,IAAI,IAAI,CAAC1B,kBAAiB,KAAM,IAAI,EAAE;QAClC8B,aAAY,GAAIA,aAAa,CAACxB,MAAM,CAACqB,IAAG,IAAK,IAAI,CAACnC,SAAS,CAACiB,QAAQ,CAACkB,IAAI,CAACI,EAAE,CAAC,CAAC;MAClF;MACA,OAAOD,aAAa;IACxB;EAEJ,CAAC;EAGDE,OAAO,EAAE;IAEL,MAAM7B,iBAAiB,GAAE;MACrB,IAAI,CAACZ,SAAQ,GAAI,MAAMN,YAAY,EAAC;IACxC,CAAC;IAEDgD,WAAW,CAACC,MAAM,EAAE;MAEhB,OAAO,IAAI,CAAC1C,SAAS,CAACiB,QAAQ,CAACyB,MAAM,CAAC;IAE1C,CAAC;IAEDC,UAAU,CAACD,MAAM,EAAE;MACfE,OAAO,CAACC,GAAG,CAACC,QAAQ,CAACC,MAAM,CAAC;MAC5B,MAAMZ,IAAG,GAAI,IAAI,CAACD,sBAAsB,CAACc,IAAI,CAACb,IAAG,IAAKA,IAAI,CAACI,EAAC,KAAMG,MAAM,CAAC;MACzEE,OAAO,CAACC,GAAG,CAACV,IAAI,CAACc,OAAO;MACxB,IAAId,IAAI,EAAE;QAENA,IAAI,CAACc,OAAM,GAAI,CAACd,IAAI,CAACc,OAAO;QAE5B,IAAId,IAAI,CAACc,OAAO,EAAE;UACd,IAAI,CAACjD,SAAS,CAACkD,IAAI,CAACf,IAAI,CAACI,EAAE,CAAC;QAChC,OACK;UACD,MAAMY,KAAI,GAAI,IAAI,CAACnD,SAAS,CAACoD,OAAO,CAACjB,IAAI,CAACI,EAAE,CAAC;UAC7C,IAAIY,KAAI,KAAM,CAAC,CAAC,EAAE;YACd,IAAI,CAACnD,SAAS,CAACqD,MAAM,CAACF,KAAK,EAAE,CAAC,CAAC;UACnC;QACJ;QAEA3D,SAAS,CAAC,WAAW,EAAE8D,IAAI,CAACC,SAAS,CAAC,IAAI,CAACvD,SAAS,CAAC,EAAE,EAAE,CAAC;QAE1D4C,OAAO,CAACC,GAAG,CAACC,QAAQ,CAACC,MAAM,CAAC;QAC5B;QACA;;;;;MAKJ;IACJ,CAAC;;IAEDS,mBAAmB,GAAG;MAClB,IAAI,CAAChD,kBAAiB,GAAI,CAAC,IAAI,CAACA,kBAAkB;MAClDN,YAAY,CAACuD,OAAO,CAAC,oBAAoB,EAAE,IAAI,CAACjD,kBAAkB,CAAC;IACvE;EAEJ;AACJ","names":["getCookie","setCookie","getGamesData","GalleryOptions","GameCard","name","components","data","gamesData","favorites","search","localStorage","getItem","gamesSortType","gamesFilterPlat","gamesFilterGenre","gridView","gamesSortFavorites","watch","created","retrieveGamesData","computed","searchingList","filter","title","toLowerCase","includes","gamesOrganizedData","sortedData","slice","field","reversed","sort","a","b","localeCompare","Date","parse","reverse","gamesFilteredPlatData","filteredData","item","platform","gamesFilteredGenreData","game","genre","gamesFilteredFavoritesData","favoritesData","id","methods","isGameLiked","gameId","toggleLike","console","log","document","cookie","find","isLiked","push","index","indexOf","splice","JSON","stringify","toggleSortFavorites","setItem"],"sourceRoot":"","sources":["C:\\Users\\charl\\Documents\\IMAC\\2A\\S2\\PROG-WEB\\projet\\src\\components\\GamesGallery.vue"],"sourcesContent":["<template>\r\n\r\n    <GalleryOptions v-model:search=\"search\" \r\n    v-model:gamesSortType=\"gamesSortType\"\r\n    v-model:gamesFilterPlat=\"gamesFilterPlat\"\r\n    v-model:gamesFilterGenre=\"gamesFilterGenre\"\r\n    :gamesFilteredGenreData=\"gamesFilteredGenreData\"\r\n    v-model:gridView=\"gridView\"\r\n    v-model:gamesSortFavorites=\"gamesSortFavorites\"\r\n    @toggleSortFavorites=\"toggleSortFavorites\"\r\n    :favorites=\"favorites\"\r\n    />\r\n\r\n\r\n    <div class=\"games-gallery\">\r\n\r\n        <GameCard \r\n\r\n            v-for=\"game in gamesFilteredFavoritesData\" \r\n            :key=\"game.id\"\r\n            :id=\"game.id\"\r\n            :title=\"game.title\"\r\n            :thumbnail=\"game.thumbnail\"\r\n            :short_description=\"game.short_description\"  \r\n            :genre=\"game.genre\"\r\n            :platform=\"game.platform\"\r\n\r\n            @toggleLike=\"toggleLike(game.id)\" \r\n            :isLiked=\"isGameLiked(game.id)\"\r\n       \r\n\r\n            :gridView=\"gridView\"     \r\n        />\r\n    \r\n             \r\n    </div>\r\n\r\n\r\n    <div v-if=\"search && searchingList.length == []\">\r\n        <h2>Oups</h2>\r\n        <p>Aucun résultat trouvé</p>\r\n\r\n    </div>\r\n\r\n    <div v-if=\"!search && searchingList.length == []\">\r\n        <h2>Loading ...</h2>\r\n        <i class=\"fas fa-spinner fa-pulse fa-xl\"></i>\r\n\r\n    </div>\r\n  \r\n  \r\n  </template>\r\n  \r\n  <script>\r\n\r\n    import { getCookie, setCookie } from '@/services/cookies/cookieUtils';\r\n  \r\n    import { getGamesData } from '@/services/api/gamesAPI';\r\n\r\n    \r\n\r\n    import GalleryOptions from './GalleryOptions.vue'\r\n    import GameCard from './GameCard.vue';\r\n  \r\n    export default {\r\n    name : 'GamesGallery',\r\n  \r\n    components : {\r\n        GameCard,\r\n        GalleryOptions\r\n    },\r\n\r\n    data() {\r\n        return {\r\n            gamesData : [],\r\n\r\n            favorites : [],\r\n\r\n            search: localStorage.getItem(\"search\") || \"\",\r\n\t\t\tgamesSortType: localStorage.getItem(\"gamesSortType\") || \"default\",\r\n            gamesFilterPlat: localStorage.getItem(\"gamesFilterPlat\") || \"All\",\r\n            gamesFilterGenre: localStorage.getItem(\"gamesFilterGenre\") || \"default\",\r\n\r\n            gridView: localStorage.getItem(\"gridView\") === true,\r\n            \r\n           gamesSortFavorites: localStorage.getItem(\"gamesSortFavorites\") === false,\r\n        }\r\n    },\r\n\r\n    watch :{\r\n    \r\n    },\r\n\r\n    \r\n\r\n    created: function(){\r\n\r\n        this.retrieveGamesData();\r\n\r\n        \r\n\r\n    },\r\n\r\n    computed: {\r\n        searchingList(){\r\n            return this.gamesData.filter((gamesData) => {\r\n                return gamesData.title.toLowerCase().includes(this.search.toLowerCase());\r\n            })\r\n        },\r\n        \r\n        gamesOrganizedData: function() {\r\n            let sortedData = this.gamesData.slice()\r\n            const field = [\"AZName\", \"ZAName\"].includes(this.gamesSortType) ? \"title\" : [\"RecenttoOld\", \"OldtoRecent\"].includes(this.gamesSortType) ? \"release_date\" : [\"default\"].includes(this.gamesSortType);\r\n            const reversed = [\"ZAName\", \"OldtoRecent\"].includes(this.gamesSortType)\r\n            sortedData = this.searchingList.slice().sort((a, b) => {\r\n                if (field === \"title\") {\r\n                return a[field].localeCompare(b[field])\r\n                } else if (field === \"release_date\") {\r\n                return Date.parse(a[field]) - Date.parse(b[field])\r\n                }\r\n            })\r\n            if (reversed) sortedData = sortedData.reverse()\r\n            return sortedData\r\n\r\n        },\r\n\r\n        gamesFilteredPlatData: function() {        \r\n            let filteredData = this.gamesOrganizedData;\r\n            if (this.gamesFilterPlat !== 'All') {\r\n                filteredData = filteredData.filter(item => item.platform === this.gamesFilterPlat);\r\n            }\r\n            return filteredData;\r\n        },\r\n\r\n        gamesFilteredGenreData: function() {\r\n        let filteredData = this.gamesFilteredPlatData;\r\n        if (this.gamesFilterGenre !== 'default') {\r\n            filteredData = filteredData.filter(game => game.genre === this.gamesFilterGenre);\r\n        }\r\n        return filteredData;\r\n        },\r\n\r\n        gamesFilteredFavoritesData: function() {\r\n            let favoritesData = this.gamesFilteredGenreData;\r\n            if (this.gamesSortFavorites === true) {\r\n                favoritesData = favoritesData.filter(game => this.favorites.includes(game.id));\r\n            }\r\n            return favoritesData;\r\n        }\r\n        \r\n    },\r\n\r\n  \r\n    methods: {\r\n      \r\n        async retrieveGamesData(){\r\n            this.gamesData = await getGamesData()\r\n        },\r\n\r\n        isGameLiked(gameId) {\r\n            \r\n            return this.favorites.includes(gameId);\r\n            \r\n        },\r\n\r\n        toggleLike(gameId) {\r\n            console.log(document.cookie);\r\n            const game = this.gamesFilteredGenreData.find(game => game.id === gameId);\r\n            console.log(game.isLiked)\r\n            if (game) {\r\n                \r\n                game.isLiked = !game.isLiked;\r\n                \r\n                if (game.isLiked) {\r\n                    this.favorites.push(game.id);\r\n                }\r\n                else {\r\n                    const index = this.favorites.indexOf(game.id);\r\n                    if (index !== -1) {\r\n                        this.favorites.splice(index, 1);\r\n                    }\r\n                }\r\n\r\n                setCookie('favorites', JSON.stringify(this.favorites), 30);\r\n                \r\n                console.log(document.cookie);\r\n                /* Supprimer les cookies si y a un soucis */\r\n                /*var Cookies = document.cookie.split(';');\r\n                // set past expiry to all cookies\r\n                for (var i = 0; i < Cookies.length; i++) {\r\n                document.cookie = Cookies[i] + \"=; expires=\"+ new Date(0).toUTCString();\r\n                }*/\r\n            }\r\n        },\r\n\r\n        toggleSortFavorites() {\r\n            this.gamesSortFavorites = !this.gamesSortFavorites;\r\n            localStorage.setItem(\"gamesSortFavorites\", this.gamesSortFavorites);\r\n        },\r\n        \r\n    },\r\n}\r\n \r\n  </script>\r\n  \r\n  <style scoped>\r\n   .games-gallery{\r\n        display: flex;\r\n        justify-content: center;\r\n        flex-wrap: wrap;\r\n    }\r\n    \r\n  </style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}